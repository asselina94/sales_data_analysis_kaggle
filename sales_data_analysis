{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "bdedff07",
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
    "execution": {
     "iopub.execute_input": "2024-05-06T11:26:45.442774Z",
     "iopub.status.busy": "2024-05-06T11:26:45.442253Z",
     "iopub.status.idle": "2024-05-06T11:26:47.804581Z",
     "shell.execute_reply": "2024-05-06T11:26:47.803534Z"
    },
    "papermill": {
     "duration": 2.371852,
     "end_time": "2024-05-06T11:26:47.806888",
     "exception": false,
     "start_time": "2024-05-06T11:26:45.435036",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]\n"
     ]
    }
   ],
   "source": [
    "#Import Necessary package for Data Analysis\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "import datetime as dt\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "import sys\n",
    "print(sys.version)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "14087577",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T11:26:47.817765Z",
     "iopub.status.busy": "2024-05-06T11:26:47.817029Z",
     "iopub.status.idle": "2024-05-06T11:26:47.909660Z",
     "shell.execute_reply": "2024-05-06T11:26:47.908481Z"
    },
    "papermill": {
     "duration": 0.101274,
     "end_time": "2024-05-06T11:26:47.912731",
     "exception": false,
     "start_time": "2024-05-06T11:26:47.811457",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ORDERNUMBER</th>\n",
       "      <th>QUANTITYORDERED</th>\n",
       "      <th>PRICEEACH</th>\n",
       "      <th>ORDERLINENUMBER</th>\n",
       "      <th>SALES</th>\n",
       "      <th>ORDERDATE</th>\n",
       "      <th>STATUS</th>\n",
       "      <th>QTR_ID</th>\n",
       "      <th>MONTH_ID</th>\n",
       "      <th>YEAR_ID</th>\n",
       "      <th>...</th>\n",
       "      <th>ADDRESSLINE1</th>\n",
       "      <th>ADDRESSLINE2</th>\n",
       "      <th>CITY</th>\n",
       "      <th>STATE</th>\n",
       "      <th>POSTALCODE</th>\n",
       "      <th>COUNTRY</th>\n",
       "      <th>TERRITORY</th>\n",
       "      <th>CONTACTLASTNAME</th>\n",
       "      <th>CONTACTFIRSTNAME</th>\n",
       "      <th>DEALSIZE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>10107</td>\n",
       "      <td>30</td>\n",
       "      <td>95.70</td>\n",
       "      <td>2</td>\n",
       "      <td>2871.00</td>\n",
       "      <td>2/24/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>897 Long Airport Avenue</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NYC</td>\n",
       "      <td>NY</td>\n",
       "      <td>10022</td>\n",
       "      <td>USA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Yu</td>\n",
       "      <td>Kwai</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>10121</td>\n",
       "      <td>34</td>\n",
       "      <td>81.35</td>\n",
       "      <td>5</td>\n",
       "      <td>2765.90</td>\n",
       "      <td>5/7/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>10134</td>\n",
       "      <td>41</td>\n",
       "      <td>94.74</td>\n",
       "      <td>2</td>\n",
       "      <td>3884.34</td>\n",
       "      <td>7/1/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>27 rue du Colonel Pierre Avia</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Paris</td>\n",
       "      <td>NaN</td>\n",
       "      <td>75508</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Da Cunha</td>\n",
       "      <td>Daniel</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>10145</td>\n",
       "      <td>45</td>\n",
       "      <td>83.26</td>\n",
       "      <td>6</td>\n",
       "      <td>3746.70</td>\n",
       "      <td>8/25/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>3</td>\n",
       "      <td>8</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>78934 Hillside Dr.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Pasadena</td>\n",
       "      <td>CA</td>\n",
       "      <td>90003</td>\n",
       "      <td>USA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Young</td>\n",
       "      <td>Julie</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>10159</td>\n",
       "      <td>49</td>\n",
       "      <td>100.00</td>\n",
       "      <td>14</td>\n",
       "      <td>5205.27</td>\n",
       "      <td>10/10/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>4</td>\n",
       "      <td>10</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>7734 Strong St.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>San Francisco</td>\n",
       "      <td>CA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>USA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Brown</td>\n",
       "      <td>Julie</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   ORDERNUMBER  QUANTITYORDERED  PRICEEACH  ORDERLINENUMBER    SALES  \\\n",
       "0        10107               30      95.70                2  2871.00   \n",
       "1        10121               34      81.35                5  2765.90   \n",
       "2        10134               41      94.74                2  3884.34   \n",
       "3        10145               45      83.26                6  3746.70   \n",
       "4        10159               49     100.00               14  5205.27   \n",
       "\n",
       "         ORDERDATE   STATUS  QTR_ID  MONTH_ID  YEAR_ID  ...  \\\n",
       "0   2/24/2003 0:00  Shipped       1         2     2003  ...   \n",
       "1    5/7/2003 0:00  Shipped       2         5     2003  ...   \n",
       "2    7/1/2003 0:00  Shipped       3         7     2003  ...   \n",
       "3   8/25/2003 0:00  Shipped       3         8     2003  ...   \n",
       "4  10/10/2003 0:00  Shipped       4        10     2003  ...   \n",
       "\n",
       "                    ADDRESSLINE1  ADDRESSLINE2           CITY STATE  \\\n",
       "0        897 Long Airport Avenue           NaN            NYC    NY   \n",
       "1             59 rue de l'Abbaye           NaN          Reims   NaN   \n",
       "2  27 rue du Colonel Pierre Avia           NaN          Paris   NaN   \n",
       "3             78934 Hillside Dr.           NaN       Pasadena    CA   \n",
       "4                7734 Strong St.           NaN  San Francisco    CA   \n",
       "\n",
       "  POSTALCODE COUNTRY TERRITORY CONTACTLASTNAME CONTACTFIRSTNAME DEALSIZE  \n",
       "0      10022     USA       NaN              Yu             Kwai    Small  \n",
       "1      51100  France      EMEA         Henriot             Paul    Small  \n",
       "2      75508  France      EMEA        Da Cunha           Daniel   Medium  \n",
       "3      90003     USA       NaN           Young            Julie   Medium  \n",
       "4        NaN     USA       NaN           Brown            Julie   Medium  \n",
       "\n",
       "[5 rows x 25 columns]"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Load Data\n",
    "\n",
    "df = pd.read_csv('/kaggle/input/sample-sales-data/sales_data_sample.csv', encoding='ISO-8859-1')\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "25f146b0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T11:26:47.927883Z",
     "iopub.status.busy": "2024-05-06T11:26:47.926521Z",
     "iopub.status.idle": "2024-05-06T11:26:47.993753Z",
     "shell.execute_reply": "2024-05-06T11:26:47.992143Z"
    },
    "papermill": {
     "duration": 0.077639,
     "end_time": "2024-05-06T11:26:47.996568",
     "exception": false,
     "start_time": "2024-05-06T11:26:47.918929",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 2823 entries, 0 to 2822\n",
      "Data columns (total 25 columns):\n",
      " #   Column            Non-Null Count  Dtype  \n",
      "---  ------            --------------  -----  \n",
      " 0   ORDERNUMBER       2823 non-null   int64  \n",
      " 1   QUANTITYORDERED   2823 non-null   int64  \n",
      " 2   PRICEEACH         2823 non-null   float64\n",
      " 3   ORDERLINENUMBER   2823 non-null   int64  \n",
      " 4   SALES             2823 non-null   float64\n",
      " 5   ORDERDATE         2823 non-null   object \n",
      " 6   STATUS            2823 non-null   object \n",
      " 7   QTR_ID            2823 non-null   int64  \n",
      " 8   MONTH_ID          2823 non-null   int64  \n",
      " 9   YEAR_ID           2823 non-null   int64  \n",
      " 10  PRODUCTLINE       2823 non-null   object \n",
      " 11  MSRP              2823 non-null   int64  \n",
      " 12  PRODUCTCODE       2823 non-null   object \n",
      " 13  CUSTOMERNAME      2823 non-null   object \n",
      " 14  PHONE             2823 non-null   object \n",
      " 15  ADDRESSLINE1      2823 non-null   object \n",
      " 16  ADDRESSLINE2      302 non-null    object \n",
      " 17  CITY              2823 non-null   object \n",
      " 18  STATE             1337 non-null   object \n",
      " 19  POSTALCODE        2747 non-null   object \n",
      " 20  COUNTRY           2823 non-null   object \n",
      " 21  TERRITORY         1749 non-null   object \n",
      " 22  CONTACTLASTNAME   2823 non-null   object \n",
      " 23  CONTACTFIRSTNAME  2823 non-null   object \n",
      " 24  DEALSIZE          2823 non-null   object \n",
      "dtypes: float64(2), int64(7), object(16)\n",
      "memory usage: 551.5+ KB\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ORDERNUMBER</th>\n",
       "      <th>QUANTITYORDERED</th>\n",
       "      <th>PRICEEACH</th>\n",
       "      <th>ORDERLINENUMBER</th>\n",
       "      <th>SALES</th>\n",
       "      <th>QTR_ID</th>\n",
       "      <th>MONTH_ID</th>\n",
       "      <th>YEAR_ID</th>\n",
       "      <th>MSRP</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>2823.000000</td>\n",
       "      <td>2823.000000</td>\n",
       "      <td>2823.000000</td>\n",
       "      <td>2823.000000</td>\n",
       "      <td>2823.000000</td>\n",
       "      <td>2823.000000</td>\n",
       "      <td>2823.000000</td>\n",
       "      <td>2823.00000</td>\n",
       "      <td>2823.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>10258.725115</td>\n",
       "      <td>35.092809</td>\n",
       "      <td>83.658544</td>\n",
       "      <td>6.466171</td>\n",
       "      <td>3553.889072</td>\n",
       "      <td>2.717676</td>\n",
       "      <td>7.092455</td>\n",
       "      <td>2003.81509</td>\n",
       "      <td>100.715551</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>92.085478</td>\n",
       "      <td>9.741443</td>\n",
       "      <td>20.174277</td>\n",
       "      <td>4.225841</td>\n",
       "      <td>1841.865106</td>\n",
       "      <td>1.203878</td>\n",
       "      <td>3.656633</td>\n",
       "      <td>0.69967</td>\n",
       "      <td>40.187912</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>10100.000000</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>26.880000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>482.130000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>2003.00000</td>\n",
       "      <td>33.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>10180.000000</td>\n",
       "      <td>27.000000</td>\n",
       "      <td>68.860000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>2203.430000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>2003.00000</td>\n",
       "      <td>68.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>10262.000000</td>\n",
       "      <td>35.000000</td>\n",
       "      <td>95.700000</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>3184.800000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>8.000000</td>\n",
       "      <td>2004.00000</td>\n",
       "      <td>99.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>10333.500000</td>\n",
       "      <td>43.000000</td>\n",
       "      <td>100.000000</td>\n",
       "      <td>9.000000</td>\n",
       "      <td>4508.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>11.000000</td>\n",
       "      <td>2004.00000</td>\n",
       "      <td>124.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>10425.000000</td>\n",
       "      <td>97.000000</td>\n",
       "      <td>100.000000</td>\n",
       "      <td>18.000000</td>\n",
       "      <td>14082.800000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>12.000000</td>\n",
       "      <td>2005.00000</td>\n",
       "      <td>214.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        ORDERNUMBER  QUANTITYORDERED    PRICEEACH  ORDERLINENUMBER  \\\n",
       "count   2823.000000      2823.000000  2823.000000      2823.000000   \n",
       "mean   10258.725115        35.092809    83.658544         6.466171   \n",
       "std       92.085478         9.741443    20.174277         4.225841   \n",
       "min    10100.000000         6.000000    26.880000         1.000000   \n",
       "25%    10180.000000        27.000000    68.860000         3.000000   \n",
       "50%    10262.000000        35.000000    95.700000         6.000000   \n",
       "75%    10333.500000        43.000000   100.000000         9.000000   \n",
       "max    10425.000000        97.000000   100.000000        18.000000   \n",
       "\n",
       "              SALES       QTR_ID     MONTH_ID     YEAR_ID         MSRP  \n",
       "count   2823.000000  2823.000000  2823.000000  2823.00000  2823.000000  \n",
       "mean    3553.889072     2.717676     7.092455  2003.81509   100.715551  \n",
       "std     1841.865106     1.203878     3.656633     0.69967    40.187912  \n",
       "min      482.130000     1.000000     1.000000  2003.00000    33.000000  \n",
       "25%     2203.430000     2.000000     4.000000  2003.00000    68.000000  \n",
       "50%     3184.800000     3.000000     8.000000  2004.00000    99.000000  \n",
       "75%     4508.000000     4.000000    11.000000  2004.00000   124.000000  \n",
       "max    14082.800000     4.000000    12.000000  2005.00000   214.000000  "
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Review the data\n",
    "df.size\n",
    "df.info()\n",
    "df.describe()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fe3c3a5f",
   "metadata": {
    "papermill": {
     "duration": 0.004883,
     "end_time": "2024-05-06T11:26:48.006901",
     "exception": false,
     "start_time": "2024-05-06T11:26:48.002018",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "1. There are a few columns has null value, like: addressline2, state, postalcode, and territory, which deserves a futher exploartion and decision of null values\n",
    "2. As all column name are in upppercase, I'd like to change them into lowercase for easier typing\n",
    "3. Change ORDERDATE from Object type to Datetime type for EDA\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f77c8598",
   "metadata": {
    "papermill": {
     "duration": 0.006312,
     "end_time": "2024-05-06T11:26:48.018704",
     "exception": false,
     "start_time": "2024-05-06T11:26:48.012392",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Data cleaning"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "e7d5223f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T11:26:48.032809Z",
     "iopub.status.busy": "2024-05-06T11:26:48.032310Z",
     "iopub.status.idle": "2024-05-06T11:26:48.079915Z",
     "shell.execute_reply": "2024-05-06T11:26:48.078515Z"
    },
    "papermill": {
     "duration": 0.058815,
     "end_time": "2024-05-06T11:26:48.082973",
     "exception": false,
     "start_time": "2024-05-06T11:26:48.024158",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ordernumber</th>\n",
       "      <th>quantityordered</th>\n",
       "      <th>priceeach</th>\n",
       "      <th>orderlinenumber</th>\n",
       "      <th>sales</th>\n",
       "      <th>orderdate</th>\n",
       "      <th>status</th>\n",
       "      <th>qtr_id</th>\n",
       "      <th>month_id</th>\n",
       "      <th>year_id</th>\n",
       "      <th>...</th>\n",
       "      <th>addressline1</th>\n",
       "      <th>addressline2</th>\n",
       "      <th>city</th>\n",
       "      <th>state</th>\n",
       "      <th>postalcode</th>\n",
       "      <th>country</th>\n",
       "      <th>territory</th>\n",
       "      <th>contactlastname</th>\n",
       "      <th>contactfirstname</th>\n",
       "      <th>dealsize</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>10107</td>\n",
       "      <td>30</td>\n",
       "      <td>95.70</td>\n",
       "      <td>2</td>\n",
       "      <td>2871.00</td>\n",
       "      <td>2/24/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>897 Long Airport Avenue</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NYC</td>\n",
       "      <td>NY</td>\n",
       "      <td>10022</td>\n",
       "      <td>USA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Yu</td>\n",
       "      <td>Kwai</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>10121</td>\n",
       "      <td>34</td>\n",
       "      <td>81.35</td>\n",
       "      <td>5</td>\n",
       "      <td>2765.90</td>\n",
       "      <td>5/7/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>10134</td>\n",
       "      <td>41</td>\n",
       "      <td>94.74</td>\n",
       "      <td>2</td>\n",
       "      <td>3884.34</td>\n",
       "      <td>7/1/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>27 rue du Colonel Pierre Avia</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Paris</td>\n",
       "      <td>NaN</td>\n",
       "      <td>75508</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Da Cunha</td>\n",
       "      <td>Daniel</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3 rows × 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   ordernumber  quantityordered  priceeach  orderlinenumber    sales  \\\n",
       "0        10107               30      95.70                2  2871.00   \n",
       "1        10121               34      81.35                5  2765.90   \n",
       "2        10134               41      94.74                2  3884.34   \n",
       "\n",
       "        orderdate   status  qtr_id  month_id  year_id  ...  \\\n",
       "0  2/24/2003 0:00  Shipped       1         2     2003  ...   \n",
       "1   5/7/2003 0:00  Shipped       2         5     2003  ...   \n",
       "2   7/1/2003 0:00  Shipped       3         7     2003  ...   \n",
       "\n",
       "                    addressline1  addressline2   city state postalcode  \\\n",
       "0        897 Long Airport Avenue           NaN    NYC    NY      10022   \n",
       "1             59 rue de l'Abbaye           NaN  Reims   NaN      51100   \n",
       "2  27 rue du Colonel Pierre Avia           NaN  Paris   NaN      75508   \n",
       "\n",
       "  country territory contactlastname contactfirstname dealsize  \n",
       "0     USA       NaN              Yu             Kwai    Small  \n",
       "1  France      EMEA         Henriot             Paul    Small  \n",
       "2  France      EMEA        Da Cunha           Daniel   Medium  \n",
       "\n",
       "[3 rows x 25 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "change_column_name_lower = []\n",
    "\n",
    "for column in df.columns:\n",
    "    change_column_name_lower.append(column.lower())\n",
    "    \n",
    "change_column_name_lower\n",
    "\n",
    "#Rename column name by index\n",
    "\n",
    "for i in range(0,len(df.columns),1):\n",
    "    df = df.rename(columns = {df.columns[i] : str(change_column_name_lower[i])})\n",
    "    \n",
    "df.head(3)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8eb0d7e3",
   "metadata": {
    "papermill": {
     "duration": 0.005273,
     "end_time": "2024-05-06T11:26:48.094026",
     "exception": false,
     "start_time": "2024-05-06T11:26:48.088753",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Explore Null Values and Duplicates"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "7f9118b4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T11:26:48.107802Z",
     "iopub.status.busy": "2024-05-06T11:26:48.107336Z",
     "iopub.status.idle": "2024-05-06T11:26:48.123982Z",
     "shell.execute_reply": "2024-05-06T11:26:48.122149Z"
    },
    "papermill": {
     "duration": 0.027683,
     "end_time": "2024-05-06T11:26:48.127472",
     "exception": false,
     "start_time": "2024-05-06T11:26:48.099789",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "There are 0 duplicates\n"
     ]
    }
   ],
   "source": [
    "# check duplicates\n",
    "print('There are {} duplicates'.format(df.duplicated().sum()))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "e56300a6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T11:26:48.141803Z",
     "iopub.status.busy": "2024-05-06T11:26:48.141308Z",
     "iopub.status.idle": "2024-05-06T11:26:48.376038Z",
     "shell.execute_reply": "2024-05-06T11:26:48.374211Z"
    },
    "papermill": {
     "duration": 0.245684,
     "end_time": "2024-05-06T11:26:48.378939",
     "exception": false,
     "start_time": "2024-05-06T11:26:48.133255",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style type=\"text/css\">\n",
       "#T_b58d7_row0_col0, #T_b58d7_row1_col0, #T_b58d7_row2_col0, #T_b58d7_row3_col0, #T_b58d7_row4_col0, #T_b58d7_row5_col0, #T_b58d7_row6_col0, #T_b58d7_row7_col0, #T_b58d7_row8_col0, #T_b58d7_row9_col0, #T_b58d7_row10_col0, #T_b58d7_row11_col0, #T_b58d7_row12_col0, #T_b58d7_row13_col0, #T_b58d7_row14_col0, #T_b58d7_row15_col0, #T_b58d7_row17_col0, #T_b58d7_row20_col0, #T_b58d7_row22_col0, #T_b58d7_row23_col0, #T_b58d7_row24_col0 {\n",
       "  background-color: #f7fbff;\n",
       "  color: #000000;\n",
       "}\n",
       "#T_b58d7_row16_col0 {\n",
       "  background-color: #08306b;\n",
       "  color: #f1f1f1;\n",
       "}\n",
       "#T_b58d7_row18_col0 {\n",
       "  background-color: #4e9acb;\n",
       "  color: #f1f1f1;\n",
       "}\n",
       "#T_b58d7_row19_col0 {\n",
       "  background-color: #f2f7fd;\n",
       "  color: #000000;\n",
       "}\n",
       "#T_b58d7_row21_col0 {\n",
       "  background-color: #89bedc;\n",
       "  color: #000000;\n",
       "}\n",
       "</style>\n",
       "<table id=\"T_b58d7\">\n",
       "  <thead>\n",
       "    <tr>\n",
       "      <th class=\"blank level0\" >&nbsp;</th>\n",
       "      <th id=\"T_b58d7_level0_col0\" class=\"col_heading level0 col0\" >0</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th id=\"T_b58d7_level0_row0\" class=\"row_heading level0 row0\" >ordernumber</th>\n",
       "      <td id=\"T_b58d7_row0_col0\" class=\"data row0 col0\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_b58d7_level0_row1\" class=\"row_heading level0 row1\" >quantityordered</th>\n",
       "      <td id=\"T_b58d7_row1_col0\" class=\"data row1 col0\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_b58d7_level0_row2\" class=\"row_heading level0 row2\" >priceeach</th>\n",
       "      <td id=\"T_b58d7_row2_col0\" class=\"data row2 col0\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_b58d7_level0_row3\" class=\"row_heading level0 row3\" >orderlinenumber</th>\n",
       "      <td id=\"T_b58d7_row3_col0\" class=\"data row3 col0\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_b58d7_level0_row4\" class=\"row_heading level0 row4\" >sales</th>\n",
       "      <td id=\"T_b58d7_row4_col0\" class=\"data row4 col0\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_b58d7_level0_row5\" class=\"row_heading level0 row5\" >orderdate</th>\n",
       "      <td id=\"T_b58d7_row5_col0\" class=\"data row5 col0\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_b58d7_level0_row6\" class=\"row_heading level0 row6\" >status</th>\n",
       "      <td id=\"T_b58d7_row6_col0\" class=\"data row6 col0\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_b58d7_level0_row7\" class=\"row_heading level0 row7\" >qtr_id</th>\n",
       "      <td id=\"T_b58d7_row7_col0\" class=\"data row7 col0\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_b58d7_level0_row8\" class=\"row_heading level0 row8\" >month_id</th>\n",
       "      <td id=\"T_b58d7_row8_col0\" class=\"data row8 col0\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_b58d7_level0_row9\" class=\"row_heading level0 row9\" >year_id</th>\n",
       "      <td id=\"T_b58d7_row9_col0\" class=\"data row9 col0\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_b58d7_level0_row10\" class=\"row_heading level0 row10\" >productline</th>\n",
       "      <td id=\"T_b58d7_row10_col0\" class=\"data row10 col0\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_b58d7_level0_row11\" class=\"row_heading level0 row11\" >msrp</th>\n",
       "      <td id=\"T_b58d7_row11_col0\" class=\"data row11 col0\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_b58d7_level0_row12\" class=\"row_heading level0 row12\" >productcode</th>\n",
       "      <td id=\"T_b58d7_row12_col0\" class=\"data row12 col0\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_b58d7_level0_row13\" class=\"row_heading level0 row13\" >customername</th>\n",
       "      <td id=\"T_b58d7_row13_col0\" class=\"data row13 col0\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_b58d7_level0_row14\" class=\"row_heading level0 row14\" >phone</th>\n",
       "      <td id=\"T_b58d7_row14_col0\" class=\"data row14 col0\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_b58d7_level0_row15\" class=\"row_heading level0 row15\" >addressline1</th>\n",
       "      <td id=\"T_b58d7_row15_col0\" class=\"data row15 col0\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_b58d7_level0_row16\" class=\"row_heading level0 row16\" >addressline2</th>\n",
       "      <td id=\"T_b58d7_row16_col0\" class=\"data row16 col0\" >2521</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_b58d7_level0_row17\" class=\"row_heading level0 row17\" >city</th>\n",
       "      <td id=\"T_b58d7_row17_col0\" class=\"data row17 col0\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_b58d7_level0_row18\" class=\"row_heading level0 row18\" >state</th>\n",
       "      <td id=\"T_b58d7_row18_col0\" class=\"data row18 col0\" >1486</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_b58d7_level0_row19\" class=\"row_heading level0 row19\" >postalcode</th>\n",
       "      <td id=\"T_b58d7_row19_col0\" class=\"data row19 col0\" >76</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_b58d7_level0_row20\" class=\"row_heading level0 row20\" >country</th>\n",
       "      <td id=\"T_b58d7_row20_col0\" class=\"data row20 col0\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_b58d7_level0_row21\" class=\"row_heading level0 row21\" >territory</th>\n",
       "      <td id=\"T_b58d7_row21_col0\" class=\"data row21 col0\" >1074</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_b58d7_level0_row22\" class=\"row_heading level0 row22\" >contactlastname</th>\n",
       "      <td id=\"T_b58d7_row22_col0\" class=\"data row22 col0\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_b58d7_level0_row23\" class=\"row_heading level0 row23\" >contactfirstname</th>\n",
       "      <td id=\"T_b58d7_row23_col0\" class=\"data row23 col0\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th id=\"T_b58d7_level0_row24\" class=\"row_heading level0 row24\" >dealsize</th>\n",
       "      <td id=\"T_b58d7_row24_col0\" class=\"data row24 col0\" >0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n"
      ],
      "text/plain": [
       "<pandas.io.formats.style.Styler at 0x7d77c08035e0>"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# check null values\n",
    "isnull = pd.DataFrame(df.isnull().sum())\n",
    "isnull.style.background_gradient(cmap='Blues')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "2d6f724e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T11:26:48.394457Z",
     "iopub.status.busy": "2024-05-06T11:26:48.393882Z",
     "iopub.status.idle": "2024-05-06T11:26:48.405795Z",
     "shell.execute_reply": "2024-05-06T11:26:48.404020Z"
    },
    "papermill": {
     "duration": 0.022749,
     "end_time": "2024-05-06T11:26:48.408706",
     "exception": false,
     "start_time": "2024-05-06T11:26:48.385957",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2822\n",
      "addressline2 missing: 89.33%\n",
      "2822\n",
      "state missing: 52.66%\n",
      "2822\n",
      "territory missing: 38.06%\n",
      "2822\n",
      "postalcode missing: 2.69%\n"
     ]
    }
   ],
   "source": [
    "# check null values proportions\n",
    "null_values_cols = ['addressline2','state','territory','postalcode']\n",
    "\n",
    "for col in null_values_cols:\n",
    "    percentage = round((df[col].isnull().sum()/df.index[-1]*100),2)\n",
    "    print(df.index[-1])\n",
    "    print(f'{col} missing: {percentage}%')\n",
    "    \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "284ea718",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T11:26:48.423448Z",
     "iopub.status.busy": "2024-05-06T11:26:48.422995Z",
     "iopub.status.idle": "2024-05-06T11:26:48.445056Z",
     "shell.execute_reply": "2024-05-06T11:26:48.444032Z"
    },
    "papermill": {
     "duration": 0.032818,
     "end_time": "2024-05-06T11:26:48.447723",
     "exception": false,
     "start_time": "2024-05-06T11:26:48.414905",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "country    state        \n",
       "Australia  NSW               92\n",
       "           Victoria          78\n",
       "           Queensland        15\n",
       "Canada     BC                48\n",
       "           Quebec            22\n",
       "Japan      Tokyo             32\n",
       "           Osaka             20\n",
       "UK         Isle of Wight     26\n",
       "USA        CA               416\n",
       "           MA               190\n",
       "           NY               178\n",
       "           PA                75\n",
       "           CT                61\n",
       "           NH                34\n",
       "           NV                29\n",
       "           NJ                21\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# relationahip country and state\n",
    "df.groupby(by = ['country']).value_counts(['state'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "c39ff972",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T11:26:48.462970Z",
     "iopub.status.busy": "2024-05-06T11:26:48.462481Z",
     "iopub.status.idle": "2024-05-06T11:26:48.476974Z",
     "shell.execute_reply": "2024-05-06T11:26:48.475843Z"
    },
    "papermill": {
     "duration": 0.024821,
     "end_time": "2024-05-06T11:26:48.479422",
     "exception": false,
     "start_time": "2024-05-06T11:26:48.454601",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Country has # rows data missing state:\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "country\n",
       "Spain          342\n",
       "France         314\n",
       "UK             118\n",
       "Italy          113\n",
       "Finland         92\n",
       "Norway          85\n",
       "Singapore       79\n",
       "Denmark         63\n",
       "Germany         62\n",
       "Sweden          57\n",
       "Austria         55\n",
       "Belgium         33\n",
       "Switzerland     31\n",
       "Philippines     26\n",
       "Ireland         16\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# contries with most null values\n",
    "print('Country has # rows data missing state:')\n",
    "df[df['state'].isnull()]['country'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "491a35ff",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T11:26:48.494706Z",
     "iopub.status.busy": "2024-05-06T11:26:48.493890Z",
     "iopub.status.idle": "2024-05-06T11:26:48.507731Z",
     "shell.execute_reply": "2024-05-06T11:26:48.505885Z"
    },
    "papermill": {
     "duration": 0.02442,
     "end_time": "2024-05-06T11:26:48.510389",
     "exception": false,
     "start_time": "2024-05-06T11:26:48.485969",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Country has # rows data missing state:\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "country\n",
       "USA       1004\n",
       "Canada      70\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#territory with null value\n",
    "\n",
    "print('Country has # rows data missing state:')\n",
    "df[df['territory'].isnull()]['country'].value_counts()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "377a475d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-06T11:26:48.527642Z",
     "iopub.status.busy": "2024-05-06T11:26:48.527165Z",
     "iopub.status.idle": "2024-05-06T11:26:48.536410Z",
     "shell.execute_reply": "2024-05-06T11:26:48.535052Z"
    },
    "papermill": {
     "duration": 0.019979,
     "end_time": "2024-05-06T11:26:48.538501",
     "exception": false,
     "start_time": "2024-05-06T11:26:48.518522",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Current territory label:\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "array([nan, 'EMEA', 'APAC', 'Japan'], dtype=object)"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Look into current Territory Label\n",
    "\n",
    "print('Current territory label:')\n",
    "df['territory'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4f56617a",
   "metadata": {
    "papermill": {
     "duration": 0.006718,
     "end_time": "2024-05-06T11:26:48.552374",
     "exception": false,
     "start_time": "2024-05-06T11:26:48.545656",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "datasetId": 435,
     "sourceId": 896,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 30698,
   "isGpuEnabled": false,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.13"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 7.352772,
   "end_time": "2024-05-06T11:26:49.485085",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2024-05-06T11:26:42.132313",
   "version": "2.5.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
